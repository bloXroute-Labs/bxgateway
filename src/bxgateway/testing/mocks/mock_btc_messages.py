import time

from bxcommon.constants import LISTEN_ON_IP_ADDRESS
from bxcommon.utils import crypto, convert
from bxcommon.utils.blockchain_utils.btc.btc_object_hash import BtcObjectHash
from bxcommon.utils.crypto import SHA256_HASH_LEN
from bxgateway.btc_constants import BTC_HDR_COMMON_OFF
from bxgateway.messages.btc.block_btc_message import BlockBtcMessage
from bxgateway.messages.btc.tx_btc_message import TxBtcMessage, TxIn, TxOut
from bxgateway.messages.btc.version_btc_message import VersionBtcMessage


class RealBtcBlocks:
    # contains a version 0 transactions, which we previously crashed on
    BLOCK1 = "0b110907626c6f636b000000000000001426000057da675800000020ff563d8c41fc6f1370f614dfe67c48f8d9974491529ffdea790000000000000043034e093b8ef63b6e2f4d45efc9a92466ac4e994236d26ab84a32a9f3f6b1bbb248305cffff001d1c60f0c22601000000010000000000000000000000000000000000000000000000000000000000000000ffffffff1f03e3231604b248305c00a0717a8b456f00000c2f4d696e696e67436f72652f00000000020000000000000000266a24aa21a9edcd2f7e008fc9d9516aa6ef01b0deaab9edd9e48d9b3075043fb69f77a303cbe3eeeaaf04000000001976a9146d0ca0a7bb477b9327dc7f48431ab4421570e09a88ac000000000100000001afd567cd5217aff4c4ad96ad64a144d8e3bc41f2243740b3272aadbba6ebbda2010000006a473044022035abdc9ddf00a86c3b585c1302665c4bc39490b3af73d8e1050d83e8bc277ebd022035b56e273c435381edd82bbaee57daabfd649efb33b6d72a027ce53a939d4a5501210329d0736bc74ae598b194a7c3b5bad2a4dc009898c5796bd1b5127fd66aa70f5affffffff0210270000000000001976a9145ed08fdc27585fc23aabfcb9f2b6e30affd0b04c88ac39b9b300000000001976a91438af0dd53f881e27b0cd6127c73df127a1cd4d5088ac0000000001000000018221becbc01a2438eaeadd6c794c84bd3e36a9b7b242022d1d2632b822bd5e50010000006b483045022100de4b9a28bc5d00f3f6ab23a717eb360f871b8898f7ed90e9a70610641b3bedd002205b77148d70186d7fee4397a3f7344a25b4d797d17f90922c89aff3edccfce9f001210329d0736bc74ae598b194a7c3b5bad2a4dc009898c5796bd1b5127fd66aa70f5affffffff0210270000000000001976a914a4e62f06c5b53ee620ec2e3ab780139cba8e151588ac890bb200000000001976a91438af0dd53f881e27b0cd6127c73df127a1cd4d5088ac0000000002000000011c0047e47466bbb4e4b73a8811f5aa1a96e6ada1a361ca5e24231a781ce60c25010000006a4730440220659f484576af6e8b8cd72bbf969fadbb033a6d5d089700e44ffca5573a217933022062d8b80e679086ba67a70d6268aeb54acfcddd0731fd43907884609998307d4b012102cd3b5f1cd82ceffda4c88fd9b98498a1e961fd890102cca9a6d623d117a2309cffffffff0200000000000000001976a9140e9bebc653c579886cde1eacd7f4a5d43ef9aa1588ac7e9d5e01000000001976a9148c50f2894499efa3b193524d94be4d0561f9e63c88ac0000000002000000014ef7151e41786f753a7435e11de5543750a0a34f11092f327c523a8763b520fc010000006a4730440220568e840acea6008990ebba8a10075a57d7fb9e21f189d35155e7ba7e88d384ee02204adfd0d5adcb32f96f150e6b312f3f778c3618f007acbe65f989c1c743ae03be012103f0937a3abc7cf55ee7ede5ecc2a5d8665f4e0f56bf20b4e2bb9a99b2023326f7ffffffff020000000000000000256a23535701966512ea19e958c9644ef61d3aa0a3f5a259770d0f5e790e3aabb51bbc83d364d68b0e01000000001976a914bdad1f4d02035b61fb1d237410e85d8402a1187d88ac0000000002000000011b0018e73d44cd31e580de7c7029be4e1192fd2248bd54a1cc27bc6068e3257b0100000017160014dd414b597319848f803e679b82a232bda2c1d22efeffffff02f6e315000800000017a914de76d76c1ef35d9816111008adc000e1ce5e649c872d7f10010000000017a9146756d1c14a8d48558a6dcb9dca3a8b4cd1ca7faf87e22316000200000001735545a20a834d33af38bb3c166f02fddd9eb53f8eec033673ebc21456a68f5501000000171600149febe61966878ca1b46afd81cb08d5c971321d51feffffff02c982a7000000000017a914437aef4791fd61d58582829618ef2a8c4129cb1187ba1707730e00000017a914698661b19f3ce9107aaecc88a12e95ef6ab4274487e22316000100000001cc20bd102b8d4c0c047160b221e4220a665edd02c6a741924682e9572d6dbb7d000000006b483045022100f3d3f37dbfde3a77d17f78f73f1cea7d7663f3e9905de26c3345d11985b3f445022007008dab3c964f88bce72c45e6c9b866b0b21df0730d0ff0b8e6403f3f57a0700121023d25940e999507794daea342316fa48813c8f5e8142e6c3a33d87b4be9d4a805ffffffff0250bd0600000000001976a9144f16dd97cbef85436dc12bdee1a6bc6b37181fb588ac400d0300000000001976a91493b0af1fd6d7a66f2108791f3edd0f392898fd7688ac000000000100000001e43d55754a52289b5ddd431950e4152ec3dcc9ca43573bd7747d5714e6dd3346010000006b483045022100e91063f2281034268597942a18c9c3f6862a456eaab91466ac61a16e3b9c0a1e02202164801965d90b0751e697f5d167804ad3094973a479793b6539fe5ae3bda00f012102d81c403f1aef80cd16ac737877999d186bf208c7d79ba07fb9aadaf63f0b09e9ffffffff026e9d0300000000001976a914f0bfedf1a80dfe07dcf03f4a9c380b8325484f5488aca0860100000000001976a914488ada52506846cebc22ac985e18a1b54e05d49288ac000000000200000001a1ba059b0589a670a6881063ea5e11268932abb10efc37a69110cca39e68740201000000171600146f81750fd5bbaaabd3030797376d0ee0f6f52380feffffff0260da10000000000017a914e5dc712c12a6dee18eef4a54c1d6077eabfff0618740420f000000000017a9146e0c2c887ba26d72b6a2e2aa97b67a7cf085a46587e22316000000000001489e7077bcd425ba3118a9c3dfaa71e389b4ad581abac91b0d1b6a46444a8a2a0000000000ffffffff021027000000000000160014a1e8e130102ef3e03844a3081ec888c520c5575c0ba4010000000000160014f0a3a3c2d32dcf40a11615a10ad5ecfc5d70e3aa000000000200000001102bd4b7529a3f6c3b4ced0abd6f07227986cef1810841b751d8d436ee298fe500000000171600149312473057d287228e019396cbe6f7ebece91bb0feffffff02a0860100000000001976a914ff818d003e6eae67009fe2de124ab6e62befdfa988acb40c78010000000017a914c5e3a0550094482a013baf899d7634160994b43687e223160002000000016d85ed2ce3888c0521fcc6bbfcde7efc4b26e081fe0b357c0edfe8455e5cd5750100000017160014a86e1634135ffc5b9f73a89ad0e2cf966b49298bfeffffff02815a76010000000017a9143fa174c99ce00df255ceaf4286e519d5c273894c87a0860100000000001976a914ff818d003e6eae67009fe2de124ab6e62befdfa988ace223160001000000015c4ba2432cfc7243a8540cec3c812846de1deb4e2e88012673a414791f962d0f00000000171600143cf7830d7785f0061938a0c23df82392a472851cffffffff02a086010000000000220020518610ed7b3d6b5774f4b5118927c15b63db5c6412ffea000c54976cae45e2918ded960000000000160014a9dd19ebfd5e47d003802f488a2c989e1a50ac99000000000200000001c1e0fdc04915c3c99321ecd36719f5b377b762c1423f7e8776f715cad617c3a20000000000000000000197750a0000000000160014e4b24eddd1feb942ae5450992fb355f23000400300000000020000000183e7500d2523598447b86eee73e00457da0b4f8206a63408e1ee11a7101ced32010000006a473044022029681faf642f05f4a866aa5e05666298f054eedc5d61a8f7f0e4eada1dab17df0220700fc5f59802e627a1c97668d065125d9c6fdba15023879032191511d82ebff70121038d536f967cb28fcd9001b9711cd856b0a5fa15178f40cbae2fd89d33f15d6911ffffffff0230e6020000000000220020bbf9d1d6b8e6ffe043efb5710902a5c48dcb050487dbae076a7e53675f43ff340000000000000000166a1422fe882c126ab9cc3732299a9decd668dd005d52000000000200000001a72c503605f24a4cbe44e5dc65b1d79e7dd3e83e196db03f4c9466ce9350d881010000006b483045022100aded6a14c8bbc832480f83339046a6daf6dd6c8244cadba7c59c673b15bf184c022020a0cb71d466f706c96028a65229a827c45eb1c71a35ccc82fae41e0c799f48401210331e3182aa51bdeabe035cd419e68c6370b7a90129ec68faf7ad0a082170666b2ffffffff02905f010000000000220020bbf9d1d6b8e6ffe043efb5710902a5c48dcb050487dbae076a7e53675f43ff340000000000000000166a14c49298b5748cc8a95e733601480482c98f9baad50000000001000000016923e6ad9df92beabb6e74f8d8a6fb4622a701376e1ee62b7062b9ce3d9a8663050000006b483045022100a2ea0b82cc3205b3d664329f9bbeb415969faa6ce446aa69f7d1edaebfabb5df022007b86d82ece78f869eb3e1e72554287e100fb59f142ce6c2b788c5eafd7826ed012102c78079cb210d9aacb5f4de3fa4499d36c16b41c714b4390c34b119cd80065d02ffffffff0692190000000000001976a9147aba3c0f8cdd956a66641c21df29de400f7545dc88ac92190000000000001976a91425a85d98555fdc672de719e160c3ef09f64e863b88ac92190000000000001976a9142c832abdba0ae3d123a94fac2a8271ed69674d7888ac92190000000000001976a9147df3a0cbd99018452ceb842c19edf404c4d1914488ac92190000000000001976a914dc3b203fa3e7e236ae97856b59ebffb3572f3f3c88acbfed470b000000001976a914efd7c992a06bb2ffcbd96e1e3a0c32becc85a15388ac0000000001000000016805b2a8b6f236ffa8c5c15cc341f0e2fb485fe2b3cf8f63d3922b2a01d47d0d00000000232200208901fc5e284280fc0e49f002f31dd9aed5fb8691ba1fedac660586e95ea36b0dffffffff0280f0fa02000000001976a9145d6ba19de267d43d2c8c0f9a779442a63cdf1c7388ac30dcfa020000000017a9144cd1cf5f40d39a0fccb41ef7fc87656267408be387000000000100000001509158442e908d9cd3fd26dd4f108ff0d73b8ecc3e7bfb0aef85372fc4978e7e01000000232200201275f357ea3a029413e268c95464d7a265cc04ab933c07c2a37d3e2333994df4ffffffff02a08601000000000017a914f1ee8f504e6cf454dd2b12d65b5d65f2e53ae361871df00e010000000017a91423167eb54cb24e187a35e10e175a1474c2c1a8e6870000000001000000018596ef963dae7ad5efa16d2274c26d213f0c63e6b50377dd31221d950463afcb010000006b48304502210085af39ed23c7a0f16186f06e6eddd567c6703edc9fde4f2502530fb78e76ccf702204545f6b00170c4ca48a601bb52c78c4a42812ca84908609f68051f23b1f0ad7c012102c64ec6fe99dceda7d35aae24f34c0ee554f2d0adff932325e27bb77426f870bffeffffff02ca677003000000001976a914e60190b3a9f54fd5667082bc0950b41afe1c372f88ac00e1f505000000001976a9145ab93563a289b74c355a9b9258b86f12bb84affb88ace22316000100000002bd4eb240187ef2dd21a2d75a0e7a5972a80955f11b76bfa50077944799d17b1f000000006a473044022018dd22ec33054469456d94eca39b34aef983fe6906624c0ec7b5595932173a6f02207721f353832a84a72d789703ea20d3d433cb7ada2470c37f1fc9ee21277e163f0121028f83c47759a9523f8183882340c38168f788a4acdc5420746349145ec4ca8ea8ffffffffb1be66f074d3229feaf2b8c9a8b0cf68ed6cfcb94e548d5e364bff2fbbfc427c000000006a47304402200556fa6a2dbc2c1ebcc29ba2c2cc359528535e73f25de461428c097f40e31228022035b0f1fb448e27b3297377e84afa9c9d943aa72d509fb842becd473a6b658b780121028f83c47759a9523f8183882340c38168f788a4acdc5420746349145ec4ca8ea8ffffffff013724fc42000000001976a914c579501d71add8fe6b9dd88b46b56aff27387e7488ac000000000200000002489e7077bcd425ba3118a9c3dfaa71e389b4ad581abac91b0d1b6a46444a8a2a0100000000ffffffffee54a157b73848b641453f674b78f4901c361f61c5be07fd3358a51e5917ce990000000000ffffffff02abe20a0000000000160014894fd798d1b54d156d44888e34504a76ef13396e9fb9ce0500000000160014b35dbad8f57fbd25ea56abafccfd269c159e80c0000000000100000001c89f1171526f5dd72dd55b7c02388348ee9a68d9ff3c57003dc71ff3b7851e1201000000232200202e93f0ccd73beaf08630e7cbb15c946c150ffcaa0ecac06838e8dec3ae5bae2bffffffff054db486030000000017a9142c447fa158ffc3385f40c7ecde1a821e1d5822ef874b7609000000000017a91493f64c9b675f97ccf5ba55c74962d369cad3be658731b101000000000017a9141cc494fd93dcd475fba349f49a7984e89f6e5f558756650c00000000001976a91488514e7319ca03474838832add7c7ab51e15f85888ace68a0d000000000017a914fba35d6e34fe82b72cace55e9e65c64ce2855eeb87e32316000100000001084af8be4b2a0675ef6b33d239d54b3fe7c9e84b854e60da1c82b839fbe7e43300000000fdfd0000483045022100bafbf947491002a1895feaa9fb3ee424640aebdf55395b716ddd7ccdb79672ad02200d5d22753e97fce2862b5b714828cb94efb3ec03119c31c112009bd53e7c7eb5014730440220371cb9e77d72bff03259714548be1e0c4189248096cc3963a7cbf485e01e8a670220159016f8581043da176b2eb7e2366f08335c091fb6fa292b5d626bf6cfd3004a014c69522102ed78c439e7038ec8b775ff82dbace8c04351143b4414235119008d4e0f34aae621037c5e8b5df4a2b833b17e3240fd17520bcf6732e324033fc030e4798bc181b16d2103393045380cfdbc9e8fbda97082b87bdb527a4d3f06902ec728a8932c4b2c9bc153aeffffffff02e5ff94000000000017a914e8973bcc3acaeca2a31cb73d166d18e701f635fb8732b13a000000000017a9149a6f62c2b40b892b4e705cf43e53de7d070a164787e3231600010000000191e00b017345f3540bf6fec8747d2ddad0cf15d13b9487c06a0c4cab227c9ed700000000232200202c23e9a023ea01ccb6f8ae5ef16aa6a7c0a65ecb041fcccc62c1af87213ec1dbffffffff023a2890000000000017a91470b157ac9f86fbd42a0e2ff7256bc2bb5456f64d878ad504000000000017a914183709b0651aff54f153df1f25930285c1a9490787e3231600010000000535f7ae8555a46e0dd3b501036cefa5bc6fa65db7481aa94ac71813c43b77bf2900000000fb0047304402203b5032325dfcda2609274352579a72f0540b329eaba1ea94e29e16d5e9d7215c022008a83c8ae16d18ac279f9096dff0d40aa320ff87ad032faebfd210b0691533800146304302201991ec9975b8aa15857f22ada92fb9f3ef1a7b0adc09ab80fa1bc75ff63fe0a7021f1218193951232b1e156d3e94a1a65e9a9e7603b46a267570f88f6440166195014c69522102a159fa94a2b09e4037f701b8c964098b3f2bb5107cb21d25195df21cd686831f21027a884e60050c88dcc3a83be1e3e3b26f73d9d97d3f4fc3477c701ff0a19d894621027d3f27e17848852e26a12377a1380ff9c112355c299fe230052b5f7a3196218953aeffffffff7ad63a01357621533243bc4e8c135b114760b3176821ac960fec87be7cb8f5f000000000fdfe0000483045022100eaf9bf9cb3e3a8903564ff30652d2a1b5e2ede4d5d65db8b94e84b07345225e10220568f9de986e8aa2aca86c7124370c715967a8f3cea39cfa10586930ca075ebf401483045022100956e1453b953319945257d27f63188effce29aa620e3d10fa9a3a3fb157669ff02200d25799d1f3508a8248253f922b3dcbfe2165dd18a1799d0a5a25ebb90297737014c69522102113c099d36f7205cad181551fb622ea0829e2e3230e7f7867f89298bda57af5321031f58f4a38d59f189625630ec7cd83594be53e9c16ecc373de0aa8a10bd9330ec21026e1d4b9da8c1ab719d9c4431adbda4d1ab7ca733703ec2df245df7387971e60853aeffffffff71b47c92d9edd2a02593f0dfa659c6cc44e992aa5012d2a961c25cef193c814300000000fdfd000047304402201aa4eba941208d5d4eb9babe6889d29506bfca4b30c03bc3a3b234fc72ad0e70022079cee3717176787978e9c170329920122cce99e6c183ff59c80693cbf44d221301483045022100a9628e293f910df3dd568c8ba6ed778beefd1109465f988954b7ff427afadbc802206b5adf76915b89a81188c9d35dc8ad492a3b5486fa83cea36e9b0a1d5f4021be014c69522102a159fa94a2b09e4037f701b8c964098b3f2bb5107cb21d25195df21cd686831f21027a884e60050c88dcc3a83be1e3e3b26f73d9d97d3f4fc3477c701ff0a19d894621027d3f27e17848852e26a12377a1380ff9c112355c299fe230052b5f7a3196218953aeffffffff624073ff2185f597f9fdfe5a89c89bdeb9f1e3fda44f03d91a22c7220b95ef6100000000fdfd0000483045022100b562d9a8a59501b08ecd58cfa60d9a2d9079fefd80bb458917b7f57fd49f92c502200d07d5d536c3d472d14396c4b7b527080a97b8ef2ae36dbbb49971f93975686c01473044022023032f72356c488a4a109708cf0df2a8e74dd6c7e0eb5bb89d97664d9d10ee8102203572b961299851baca0f88ac94cd329ab4008843f2145c222c50ea372da97bfe014c69522102113c099d36f7205cad181551fb622ea0829e2e3230e7f7867f89298bda57af5321031f58f4a38d59f189625630ec7cd83594be53e9c16ecc373de0aa8a10bd9330ec21026e1d4b9da8c1ab719d9c4431adbda4d1ab7ca733703ec2df245df7387971e60853aeffffffff3412206da2cdd70c95d63c5694641fe4a907999be87274a5aa539a2bf2c689d200000000fdfd0000483045022100ce30023f8d312116f06eb846ecb0bc79c9891a68af463f5065511de6ab9b7c7402200a70fbe09a485ad177a7100dd106a8c06b63e6da59a771869bfe19a5561c78d70147304402206548c4c9d804942eaa3cc5c23a443bf37885b02b1cc509b3b51ecce0e1d9687702206987fbd1c80144b70e5b6588f468c5dc0d37f9787ed22741ffd6f8fbd9147d18014c69522102113c099d36f7205cad181551fb622ea0829e2e3230e7f7867f89298bda57af5321031f58f4a38d59f189625630ec7cd83594be53e9c16ecc373de0aa8a10bd9330ec21026e1d4b9da8c1ab719d9c4431adbda4d1ab7ca733703ec2df245df7387971e60853aeffffffff01102700000000000017a91411c6281258ee3179659220a7351040b15d4d99b387e32316000100000001e8e40078e95a81f1b5330a1c30369dd3ef485c0424699ad0549fa5120be6495900000000fdfd0000483045022100f0beceba4e4d6eb6696b3233f6b8c1715591cb6a866507dd6c44211fc61ac1a102203e7f2275dbd4816db9f00c2904af9a982721df9147e9eec046ba51587569d783014730440220677bfec9a805fc643f44543045f881b29c921229e3966a1abd3743b33dd39fef0220587f922cd25f0a86033c5b4dd505fb6d76750c06e1e89ceee0ff5ef301ca7090014c695221036c527b4dafb382e0334c525f653c183992ec5f7552601deb8af68c326b4fed5f2103c889f6548960465b347c4ee7a4c764b038f0a86f7c9fa7ee96affd030ac668be2103d070d8bf67e1cdb4e5ca378c9b12158a562b258f5a6fbc60f3ff82308c25473a53aeffffffff02aa51b3000000000017a9147867f1fbc17734aba55a1c69325530403d118d0c87b0bc0b000000000017a914d366d75a540a31ce365d3643baae498ea3be168287e3231600010000000117dc4713fbdb1829bb99e94a66b6d42011f0e8684bd3944b3dbeef8d22e8cf3a010000008b483045022100a82c632f19d5439ac9f1d96e885ca9d1fbe9a50775236e998a3d7ff4cf954b9f022018b2fd8c84f2017767985bd5a6f057bc1f20a3f29aba375c1d6ffa2e2397b1b1014104494fb4afff6796542983a3aa703558a654d663d15d65595dac07af1e97e32d7c8ff39f9a1ed3b1b441d141266018d4b3ca3d2d620024290220f323a341373fe8ffffffff020000000000000000226a20aa27c490d4a37401aae724497382f870d6152ce74b0ce44e48b7e2c67dd5cb4fe46a9403000000001976a914c83ef0e339562a6ce3b6a42593f20b63f74a4b1188ac000000000100000001cb73ba019516e7304bfe8b890db26297faf82976ebfe99e2d6c5754741ef86c00100000000ffffffff02d38b00000000000017a914b65424fc48d70e2ce07167d8a780bc45713c60cd87e0870600000000001600141e55250153012a873296cea49d3d23e6a3258dcf0000000001000000057d6e8bf7cfcb5eceaa050a0cefd50470980ad582ffa46e596ef22f8914a3a62a0400000000ffffffffe8121ae8a8dbe25732e41a226472bbc7901779d0b555b6a83eb552cb1dcb35480500000000ffffffff9ce03383c9c0a14368665eb5908d9797a940967a933e22288f7522a226c12ec40200000000ffffffffbe9d55170213603c28445b4f67eefe141089aeb5e99e4d58a2d9bc03005585cb0300000000ffffffff64a0830767d3bce0698b250e6125046e569393ea306ba31aa3dbc8a8c4d897ef0200000000ffffffff0540420f000000000016001418e7c94d1f163bab13329b2a38b2b2e2a8310ed040420f000000000016001449253f33992cd4b542485c3afaf6c0c2a38ca1b640420f00000000001600149a6a127331d10f8c26dbf192b0a081e2f0b8c0ba40420f0000000000160014b99fc83fa97113baa8efe0b54ebaa9a93c0a18b740420f0000000000160014e192e2e95f34d1d281fde8a5789128aac94cef560000000001000000057d6e8bf7cfcb5eceaa050a0cefd50470980ad582ffa46e596ef22f8914a3a62a0500000000ffffffffe8121ae8a8dbe25732e41a226472bbc7901779d0b555b6a83eb552cb1dcb35480200000000ffffffff9ce03383c9c0a14368665eb5908d9797a940967a933e22288f7522a226c12ec40400000000ffffffffbe9d55170213603c28445b4f67eefe141089aeb5e99e4d58a2d9bc03005585cb0200000000ffffffff64a0830767d3bce0698b250e6125046e569393ea306ba31aa3dbc8a8c4d897ef0400000000ffffffff0540420f0000000000160014161f75172706a0db8ce16c0255f5d824a266281c40420f0000000000160014223291e0bd99e0677a222a9257d5ccfe97d71efa40420f0000000000160014574b6a538bc4e2099c9798772a0c83448be3ad8740420f0000000000160014ba62a7dc1cfa4d95617cf0db85eada19ceeb6c7840420f0000000000160014c0847f68c5bbca67ab2a1bdc4dc3254df92fa1460000000001000000057d6e8bf7cfcb5eceaa050a0cefd50470980ad582ffa46e596ef22f8914a3a62a0200000000ffffffffe8121ae8a8dbe25732e41a226472bbc7901779d0b555b6a83eb552cb1dcb35480400000000ffffffff9ce03383c9c0a14368665eb5908d9797a940967a933e22288f7522a226c12ec40600000000ffffffffbe9d55170213603c28445b4f67eefe141089aeb5e99e4d58a2d9bc03005585cb0400000000ffffffff64a0830767d3bce0698b250e6125046e569393ea306ba31aa3dbc8a8c4d897ef0600000000ffffffff0540420f00000000001600149039ffdd1848db0363cd886a694ab1870b2be56b40420f00000000001600149a90f7ca8a75aad12240acb8ac6a7aca523a86a540420f0000000000160014af65fb8d71b7707384967a250e7f76a8cb2c2e5540420f0000000000160014c05a7cadbe8697cd274799d1307a3d3c19b4fd3d40420f0000000000160014c234fbe8af26e10cd4c2f99343a9c194ed82468400000000010000000184b501a335d40a63f990807042c5f8b6fedc5a1cc1c0ee00344baff26402481c0100000000ffffffff0218053d0000000000220020fec8ac45d454e6f9ac922792b41d6964ec0a7a40c5a84e87830cbc0cf6a4aa63c624080900000000160014ae6ff238812f7fd798d29fddd8bc070d339363ee000000000100000001d8ca7b957a0e67b7826471938ad7e4bd5454961164cbee8b3624053cd51dc98801000000171600143da4bca7f16a6c40f2ec7b68c4f46c39b54bd43affffffff02cf190600000000001600143e5466ef4087ff4f1cb0d8ef3c9ff5d4d50bdc4ac0270900000000002200207ab5086f148231fba44e3302c6fcadbff2d353cd97ef1f1224df3afce640ffdc000000000100000001a24255392971ffda3cad24706857dda0ec0c2a940907f665488e285eba3cb199000000006a47304402202a07259766dc92b4e1470c084f4b283e9ea1d936f5ed63f585f87d8794b8845502200fc8aa1d3dc4ccd0c7c1e7bfaa19ae45a5842c307082a00b70051325658331650121025a52bcfd76e0a9ef06e1ea49cd3daa77f19c7949b046737d4b3d110b585b5c3afeffffff02c0cd9f00000000001976a9145294ad173ab2d80bab1536322ef206c3b54409a288ac404b4c00000000001976a9145ab93563a289b74c355a9b9258b86f12bb84affb88ace22316000200000001319d1a4e66f69c57f1eb27af0af72d89d7195515f0eea654a39504f7ffaea970010000006a4730440220286b5cda40af975896b64909a3f3b4f19e8232d783025d10e080aab422cf82f402205811a850cc2c7b11c9a9810b8e38aaebee2fff2228324c33e77d6c7b15c18128012103302e4eb0b05b217a98203494ad41ebe680246d85eb022e86ede20e749e1c8421feffffff02cef773b9000000001976a914be75edffaaaddef4cdb314e0fbe9dcf7dc51eed588ac20df3600000000001976a9149be55b48198fc693bd44ffaae38397ed4344a85588ac0000000002000000028cbca7721738595baaa654eeb1bddba2f2e4aa31ba0c36e2041606581711283e010000006b483045022100ef92d61d88e3752cabb189c8aede428d72b96fdef877f48fcae1ef2adc0d10b5022014d899bd6cdd6f4c2a533e86fb913c37094a2713359ba603213b65be97e36f610121023e1bc21d20d8d8d04fdba51b817be720ccf4a39ad3d645630f3f0163b4c5bf2bfeffffffc082a85a5e1da5bebc8eefa10239c2f8881380a2b4dbbb0fb2b8702f6710eeb802000000171600144d364912d3565b889c387eb289cae78ac4d47812feffffff05df8701000000000017a914e355c774ac4cff871d7f7c72e7bc8fd54192f4f487239f01000000000017a914080e233930f09e0ddc7d31d8e4c3b03a37ec06b487df400f000000000017a9143b61c385f0583b41ed7e9c3b5aa2e52bf33ede5787f1920100000000001976a91481cfd81e144aea28e60280a37acf860a765a0f6688aca18d0100000000001976a9148fe278735814712914e1f4dd4feacf890a0440b488ace2231600"

    BLOCK_WITNESS_REJECT = "0b110907626c6f636b0000000000000075250000462517d0000000203ec50bffd643ffc4d162c85a2cafbb50f01f87e9b7a108cb850000000000000064716ce958f303ae92fe646e1693a4da7c409c0699422845c0e6bedebebabb66b8d7345cc942011aaaf8111e2f01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff2a03f725160004b1d7345c04bb20bc1d0c3168345c00492b00000000000d2f6d696e656420627920636b2fffffffff0224f7b1040000000017a914a30c149c2c5bd53ef9410c86b05c1374ca3b2841870000000000000000266a24aa21a9ed668d7282402b867185f4f3dab551538fb85d3caf66a4ac634a23d1d1adeb9e540000000002000000012a2762c3ae3e5596e3394995a3eba47bdc2a488c0510114688b1791689cd81d300000000171600145a3a5ed57c2ef90e91297090005fb08bb8c598d3ffffffff02255dd4000000000017a914565b3f5f410d7066b649a70b06fe3d01e1a25d0e8700000000000000000e6a0c626c6f636b636861696e697a000000000100000001343363ce790a83f3d04c4580097069bba01dbc6292efca11d98ae6075bdbf535000000006a473044022049810fb0c50978f9ffee5b01389f8289e206367f4d59229ca398f314c70a609d02204189eb290a47ac6d05924d83d6541ab81cc9ee70a124ce2e8f2f67cd604b8cdf012103b59da87254f9d3ea452279d980bff9eabaf63aab307ab8bf642f316f9b58c953ffffffff029c200500000000001976a9145017ca10e0445e1ba882af250ebd2503dbc15ff188ac26772c02000000001976a91489c1a010f31336170fa2733b1ac2fc96a493ce3288ac0000000002000000018f8a17a4a3c040c7d22743be3adb4d9628037be2515ab6cf28d1cffc13913a52000000001716001412fa4ca117b83afb193180f2d31a99c24288d282feffffff02c6495f8d1d00000017a914ad6d4819c72f50b0c15149ce821394b8666ae57c87a7962e02000000001976a914e89ded401056e1decc749216cbca39261e75f76888acf62516000200000001acc57cdc8c58f2e8877658b2c6fecb362f1ea17782f98500b17f49b94a4cebf90100000017160014961d5c60103a88b1c10cda321d99e4d734519298feffffff02b734fd00000000001976a914afe583265fd8197ff50736226e81372816ed47f488ac86e006d21600000017a914c72bfc53da50fbc0b7c7d4cff8c26d8b8e65844187f62516000200000001ccdf4d8dd8d9cd820eba4be2c9a0d2fe2fa1e9628ff123ae34adaf26ba3d95730000000017160014bdb6be3eb53e3619db9c3fdc7e016fbb4c3765e1feffffff027bbe0401000000001976a914be5fbffe56345e0122e686e10b6d1de93183d5da88aca83969771100000017a914369f15f27d34f9e98db939e3e2b03f353bb9c7bb87f625160002000000016036c19f0ae48008c1e15b9546f6d34a2f8638afc1a4027243bb62d82c6686cd0100000017160014a52268b94d2454bc7a950ab73c9310ba717d9a0ffeffffff026567ed00000000001976a914a446078ecd314d13392aa1e9bb436cb2676bd8b688acfe43e6be1b00000017a9144011acd67f37f74ccef62a143083b61e2943e6c287f62516000200000001fef34a710a24262a4e9ba4c8024888e5ae134513c723395ac496480c3e47e862010000001716001458c1323401b57b1eb0c2ba0f4c3a63a2725e9217feffffff029f670701000000001976a914fe6a7861d372e9562cc30793ad8174a07b3c1b2d88acb117ed271900000017a914600c8f5d23c8eb59be1aa0276bc1bbddba92bfb487f625160002000000019b69add1be4200e4ced79de0bc7812b388d3bb80e96dcb11c4568baab19fd92b0100000017160014b0b13e222081ad95e3578a4270ac4846a27747fdfeffffff029b9374d70500000017a914cd5b0cbc7e6738f96a8cc39d24b63c770c12d378878ccfcf00000000001976a914bce168eb434d7efbc75889b39b5ea71ba046647f88acf62516000200000001081b794725bc836c973f54d01122d189494ac9590d89f683d178c3ae0d74bc0d01000000171600148932b4df8dde915f5a8d12ea3c74879ab50afe63feffffff0222c10301000000001976a914b2d246294f673838cd841b32cd85a684546b68f188ac5ee24ea40e00000017a914263f0791ca43247a37b94916e02fe528e7c4113087f62516000200000001343363ce790a83f3d04c4580097069bba01dbc6292efca11d98ae6075bdbf5350100000017160014d6be66a55025bea022d6409f1a98acc576b1a064feffffff023fad19010000000017a914c69534cc1234f39a460b02cc25cead1e5d01a84b8765e04f9f0c00000017a9147025edfad1ef44726793fe78e36f7504a5e2f83087f62516000200000001a555c9855ec50ea7f2e93cb1cb2dbbdf45f9231810886366a6fe01c32358c730010000001716001479acc678062563db47672ee1c0472c142ac8f7bcfeffffff0243eff600000000001976a91493497d1305c65bc221f07584045d9466afdb2bc788acffae589e0c00000017a9149d98130d4651b56514a922ff9fd58b507dc6e3a987f625160002000000011c6711dd069804b1131e60ee81cbef49eae89023df189e49c2c5d39292431baa01000000171600144799af2f4215886b808429e756551e0a20c9577bfeffffff02f72615f61300000017a914e5dbd4d6400b366bb1ab961a5b7d55402be11bd487bdadab000000000017a914c6953475724096ed80d2941f4eabba4be0a07fe887f62516000200000001017575306ccaf623246dffba40a5acf492ff3ded2ef0668ebdd45a9b0266f2fc0100000017160014a6a43f0b88c3609affaa1c7e21006a7058b0ccbefeffffff02bc14ee000000000017a9149299d6545b3a141e9b1624f7518a0dcb6e85398187b87ce39e1c00000017a9146054d40e980d29a38143844b824c8be63bd9a0a087f62516000200000001d7e0b2acd48a7d6a63951b9f740408877d5d760baa8f8b476a44c65a36166c20000000001716001452108a96121fcabbf19263b1cab674f88c2ef478feffffff02c97dc4d60500000017a91433f2ae4f14dc1390dabb65742680116c44b6d4078779d4af000000000017a91448f36004f61b7d4c5bdf3717158adeafd60ab33387f6251600020000000187810cd5fe343f7103083c866e7f076d35c96ea813d6d70a24d8f599dfbabcf801000000171600143ce03107b68d5fc3c1b9ef6723052bf614ae61ecfeffffff021eda4c3e1a00000016001441f175398991dffeefb48aed3ec924de98756e3165a0fd00000000001600143c4d87daf4b1ab429124ed4dfc847cc35e6e67d9f62516000100000001c3c42eacb4f85be31532a150a7681eac62ee6369208354039594f0e1dc26f41f000000006a47304402206ce29f0ca12140010b533221bd63e7a09e7562dba49bcccc32e7461f9af080ba02206ded8b625f1e370deaa83a23c5acca781745062b0b51fa9e8d7a92e1cc7c7e32012102ef9c3bf0878b17d2237c069c94d27db6ae5103cad1fe9e4df405f938ad7b84f2ffffffff02e681b700000000001976a91489acd711989115ed5156e4c3ef50b2d93d28c00b88ac9ea10b000000000017a914c13159be72e312c5a6da3078a5146aafa9d1c58287000000000100000001edb85fb2459569e1d52865674d5b1cd15d7a3e4b5ba07a95d1e3465d5c20e5e9010000006b483045022100a379fc59fac1469e0a77ad7cd169b0f4ec120d2904e45c8016e9a5b2ce461c0a02200c56956aeef1ac612d32456d9168fcdf54a1f61e51757947e6ce5ad40d24cc3e012103aec5d2bfe4cceae1f5cd834697688e20d207cc5ebb2b1b73c8c66ed6241ba7c7ffffffff02e9ab0000000000001976a914ee85b603acb3a9ec5fff32a2c1f05a5c29ac48a788acc9930200000000001976a91438c1525e76ea32f5ad508f89a962a3029a49f67f88ac000000000200000001004a5e0519a5bf44c7cb50a7b4c0eab0522f8afed4f452379a271e845ef53eff0000000017160014962898556f11702108a3601a798a81863557e6bbfeffffff02e05f10000000000017a91438feb671c3093af4f4d8ffaa2ae9f77159c675f287400d0300000000001976a9142077dc96cf718e0c8bb37b7a12a7f7819b56d33788acf6251600020000000159159e219ae498f347814ea4df58e6cc8d23e21a6d331e1faa713aba6bd4c7c40000000017160014454a0927390ce83e674ee2518e2f183466304cdffeffffff0210270000000000001976a91410594265555fe43503b41d3b7a516c11a7002ce488ac70800f000000000017a914f6fd0f001b72bdfdcd6721bf6b0894c40e2c6ed687f625160002000000037e0b0807ad3e0f7322d1133389edac3b69d7b40bb6ae0cc0632b1dee6f23f7110100000017160014246745c00ea1c476863a1a1fa532424e743547b1feffffff9d05baac1e01699b5e9f3d9784246c1a3419fe0232dc2484df2b1dc98b9868c50100000017160014949d5e25fb86cd2c2f41a86c7f9491b99f6144c7fefffffffe1b03f8d1b4e6929ada64395c8b11194ed0c80c059dbaf3c2804d0ee4246af201000000171600144fa30c21077bd0b749a6f9a756a655b95127e0f1feffffff02a0860100000000001976a914ff818d003e6eae67009fe2de124ab6e62befdfa988ac59580f000000000017a9141334533942216a0aeb7408ac4df4f357b131ba2d87f62516000200000001d8a71fd2360b67a31002e788aba8c7e842d3decf658880b365c8553aa40e10210100000017160014b67f22d90b6c9fcf34ec84fe5ab19324aeb053d4feffffff0296173c020000000017a9147cbd1d513121ef8f527d0b22edc86fafeda9df3887a0860100000000001976a914ff818d003e6eae67009fe2de124ab6e62befdfa988acf62516000100000001d3b2d43e9601b3da6e264fda219eed9aacb58599fe525075836ee2d1e187f2e1000000006b48304502210096984b80bbb22176228c754156337e3626f34745ded5be55bdcfacc4a2795b8f0220322ccdc1fff8678f2b6c372091d11e5b1d756be2a2e285f7b257de2c4ec1f4ad01210358670ef559d5ff2f4032b66c6d8eafa87feeafaa2f4b52db90300aef754b7cffffffffff02d9f02402000000001976a914bf1e72331f8018f66faec356a04ca98b35bf5ee288ac0000000000000000226a208139117ebe92c9d98eed1cc321d0fa29afc36eb59884875fa563d296052a5646000000000200000001ecc3de675cf370654382a0a8375612017569356d589b88f71c428b8813f4c4c6000000000090000000015ba75a000000000016001491be90f5db33f3591e54f7c7e9e0bd9e9928047bf62516000100000001571c7566001a9807ddaab4fb4a89440534ffabe84f3f1932d7dc7998809da1530000000017160014c4b7d4fe0803fb32f84366234e77421a196ea06fffffffff0247ee180000000000160014f80d2212016e54dac73447d878993c1944ee91ceffffff0000000000220020303cf14f4f9e55ba57157daf6287fa12ba8da96ef1069cace9e11005f56faf41000000000100000001aa5c2e32b0e41c7dc3760b23785ee27bc3efe5cd38466a85c5292af96754df330000000000ffffffff025de20a00000000002200202f9aafca0fe233aac32471eccf149c60e47e8f96983de98b497d146304e1b8e615ee0d000000000016001473f0eb515992168f7c11a1f3aabf7ecba6c51eae00000000010000000184568f7bc8657c15d462c246ba8097274a3fcb1d73503eaea5a02cd6bbe8eb72050000006a47304402206ce250ede00074746c28b89b9222b8c4dd18f9e589d371cd38d82723058883860220556f1f22962d20daa6699690571f94d4231551d3db8975b2ea961fd7c913fe31012102c78079cb210d9aacb5f4de3fa4499d36c16b41c714b4390c34b119cd80065d02ffffffff0692190000000000001976a9147aba3c0f8cdd956a66641c21df29de400f7545dc88ac92190000000000001976a91425a85d98555fdc672de719e160c3ef09f64e863b88ac92190000000000001976a9142c832abdba0ae3d123a94fac2a8271ed69674d7888ac92190000000000001976a9147df3a0cbd99018452ceb842c19edf404c4d1914488ac92190000000000001976a914dc3b203fa3e7e236ae97856b59ebffb3572f3f3c88ac695f110b000000001976a914efd7c992a06bb2ffcbd96e1e3a0c32becc85a15388ac00000000010000000329946dd97e3c6d13d1a3fac67509df9b97e075d480b1a95a2d1b1570e94f2b3d010000006a47304402201f2db8b3a64a6b41a03270118d4d83e500900088d4ce25c5eeffe6d9c4889cff022008d71b522359cd50f79a3c73c6422573616c531208d0172127fe8ab46fcf78870121030213ed94986f9e2ef8f4bdf9bfbd4a0760d13993bb6be2f97c583943ddd65aeaffffffff01678a9e2ed2437751185bbb29d665d748008ffbcb179ee0522afc5126234ee9000000006b483045022100b774eab128e234a7b5d4da694a4042523ba1566fb992048edf30393136bc794502201ee64633e128eca383ba508d423eb553aa74c7b3b65e2cde7e393c0db13737c90121026d5cd77dc927d4fb69ee41c558c159c90a94138c4d9f07667d4c42ccf0ce9d98ffffffff5599b314e127ef9f7a01bcb5dc01009f19cb78311a20b75587ea297e4e7d004a000000006b483045022100eaf11934f17f216d2ec72fa2aabe9d09fd5e15c7d4f7df206bc77f39d09009210220658b89d4368b10cd7dd4c2ede0575829292fb4a7acc928668dac54a65deeca24012102c76b08ddbc4c123707c230b29d22bdee495730f6653297ec0925ac8809b1e425ffffffff0200bf4000000000001976a914396b2a901526cd1cfaa2b620095c0abdbfdbe85888ac002d31010000000017a914a71e80914946b56925969494c51b1cd6310f1fff87000000000100000001e525e20f11afee0ed2b16ec6bbeecc031b76144da1e094a146bdd80a530101f40000000023220020f3178d4322edf014710d828cab1c17fb00e423919eb630c2a17a17de336361bdffffffff02108344000000000017a9149eca5e681ed3fbe2dd522dc264241c5b4d2948fe87463700000000000017a9142a21749f07284d60380c100f2228adb5e685a291870000000001000000012370e87506436cb22a52acb86ff9312db8c199f87c9b0e8da0864b702b466ae10000000023220020f3178d4322edf014710d828cab1c17fb00e423919eb630c2a17a17de336361bdffffffff02108344000000000017a9149eca5e681ed3fbe2dd522dc264241c5b4d2948fe87463700000000000017a9142a21749f07284d60380c100f2228adb5e685a291870000000001000000082d5b2213b96fd22db6fb50dbde741ad1f253a848ed4d754017aced56b0d134860000000023220020f3178d4322edf014710d828cab1c17fb00e423919eb630c2a17a17de336361bdffffffff3d4cf5ae58b5d0b7477a79a57d86540226c66ec8802665278080117bb9e2323c0000000023220020f3178d4322edf014710d828cab1c17fb00e423919eb630c2a17a17de336361bdffffffff3d4cf5ae58b5d0b7477a79a57d86540226c66ec8802665278080117bb9e2323c0100000023220020a458a931f25cb1d72b2a6532ab94e573d1d85e8639b9e8588d8577680b01597dffffffffc9bb9d1d4831b064a67da640664fdf214d31e7badba44c26cee349112d08c8040000000023220020aff8ba78a80251ad6be9237f419ff1c780bb2cad5da3451d19a42d3e1955718bffffffffc9bb9d1d4831b064a67da640664fdf214d31e7badba44c26cee349112d08c8040100000023220020f3178d4322edf014710d828cab1c17fb00e423919eb630c2a17a17de336361bdffffffffb86b051152e6abae2224488051d484dabb8734eebc2d37981b8c55817082e0020000000023220020aff8ba78a80251ad6be9237f419ff1c780bb2cad5da3451d19a42d3e1955718bffffffffb86b051152e6abae2224488051d484dabb8734eebc2d37981b8c55817082e0020100000023220020f3178d4322edf014710d828cab1c17fb00e423919eb630c2a17a17de336361bdffffffff2fda27beeb35ee978ed82ec9d9cbe8404a068f8338e1ec61f93b40f2fbd805220000000023220020aff8ba78a80251ad6be9237f419ff1c780bb2cad5da3451d19a42d3e1955718bffffffff0270f278010000000017a9146a1acec946918bb18bd746f3aefcb688d552d8f287990f10000000000017a9149eca5e681ed3fbe2dd522dc264241c5b4d2948fe87000000000200000002f8b48f7f7e12518dfc8313d3443ceb5f84c18b77a123b49e95012f1d8fd061c5000000001716001468df8dc52812e1ab3e9ee79fdf970663f0bb57bafeffffff32da3e1ad9a600c4953889812cda8dc2e59adc2d8d6844131a2329b10bc96cb5000000001716001475b13f2fd5bb329bdac840269cbc8a0137dedbf6feffffff0228410f000000000017a914e939ad8026ebb8e170c6c1ddc5295c0d193eed388760670100000000001976a914f693898a8ac70d07334c990a064aac4077c93d8288acf625160002000000024e43fa3ca892bb96a97b8e07aeee2f9c8fda4c83b118952f12507934534bcdb1010000006a47304402205f19bc92e603e484224d704b63c19dd7640fd3eabbfc01e81bf12b2c39ceccd102206297031434140c92ad29a07b561511d7e81b2e4acf1153ee5586ae5ecba72418012103d6ad962f59553adc372e241cd10db2d27e0b1a21ba692b1f748a1596d1085915feffffff4e43fa3ca892bb96a97b8e07aeee2f9c8fda4c83b118952f12507934534bcdb1000000006b48304502210092efd4dc036e5c98c22de46e52ead4616e7fffb08d1c1ab4e51fcbd52c03b94b02203220a98f11d50881a8d915846a3df678d4857242e6d3997b1c8c28df2553f2b5012103d6ad962f59553adc372e241cd10db2d27e0b1a21ba692b1f748a1596d1085915feffffff0322020000000000001976a914a8be108f4fa9f8b1a4df46fec0269c4dd8bc4e8a88ac21ea1d01000000001976a914a8be108f4fa9f8b1a4df46fec0269c4dd8bc4e8a88ac0000000000000000166a146f6d6e690000000000000002000000024e147c60000000000100000001f4f3730704d8491d39db57d2fcadcd2a181bdd65ade73c7d17fc6b1c3feaf43e0000000017160014ca7b999200d4ea6887f42ea7ca353b55bc0a4866fdffffff0240420f000000000017a914ffd0dbb44402d5f8f12d9ba5b484a2c1bb47da42872a5289000000000017a914b77a49faa429f614a1401e10e39ebaa49d106f8c8700000000010000000160b1f954e1fefabdeaba845b9d6d7b3a0f2a0a632157bfd6cfab95ceecd2edb3010000008b483045022100ac8cbe23fa9f5fdcc7747331afb53ee2bea60712c669aa0bc07d114641097df7022028b9ae954c3c4750aeca44cd8e51408ab29b7f6d090d68173121ec8aee7b2890014104494fb4afff6796542983a3aa703558a654d663d15d65595dac07af1e97e32d7c8ff39f9a1ed3b1b441d141266018d4b3ca3d2d620024290220f323a341373fe8ffffffff020000000000000000226a2052762e81232f86a2690e037c1002b3b984249b05684f08686fc09cc28ad12ebe948e9303000000001976a914c83ef0e339562a6ce3b6a42593f20b63f74a4b1188ac0000000001000000011cc9f525411130a57c43e9da082146f4129b1057fedc7b0872cb484867136cb80100000023220020b573479a8de36b52cb9db6fef12abe6d4557e497c4b5764cbaddead6b254097bffffffff0277ddda020000000017a914a54e49e6e4bb63d421ae3c52bdd6efeac27233b48740420f000000000017a914dea4c5a29ef73b86e2460ce098e399107ada6ed287f72516000100000001a6f56fe3726496172f5d0241e4fe47fcd9f0b0356d70ae16d3a9677009d36f7a0000000023220020417d9a42f248d047d8f982ec73ed3b72f233ce8585e9d1fb8a65bb39f24471f1ffffffff0240420f000000000017a91431834f6558f4b2047311b9e061d8964313548ce7871699cb020000000017a9148808c6cbd6764222090ed0485971cf88528f073087f725160001000000013952e0abc4d6d3feb770fa455f5fd465e98e99b720eb03828e4c43b66bac68d20100000023220020d4861ecb3b933c22aede8d8ef59f9029911f49c29b32f37e883d24d273ed51e5ffffffff02ea87c1010000000017a914e3002aeb0e58e2fa480722aa9bf48e2663d163de87a06a03000000000017a914f9fc89e847c392e8ad3c4c628e5acf2b0be7a97b87f72516000100000001980d14497b474bd7ef8a01ce09c087a8b63f7e5fb0103781d6b39228b49e79b100000000232200204eac874fdc0a47264651589390e4e8da233dcb0850112b1310a491340e0570a3ffffffff02a06a03000000000017a914f9fc89e847c392e8ad3c4c628e5acf2b0be7a97b875a64c2000000000017a9145a27d4b7b49c4c1053dbaac2c59d23aed4c9558c87f72516000200000001aedfc168a1681e7cce7f4c275536a363ec4e6afa971285ff6624a5395022a1b3000000000000000000016ec320000000000022002012f271e2ba58ba568b699162b65736be6cac2945fc554ee73f7332be5c836721f625160001000000014b34af1d0a9726e7655bd1e00ba4ab7d0990f475445e10a6de60f2a3518a6573000000006b483045022100b2a7fbfe9973c7f3c9c96798ace7c7d1299116ac7ff271af6abded43fa9a59ad022030c3cc79d6d9803f2b5a56e17b94219992f402367c33db29664810db7dd1e1890121035b7cc82fab7aed5e418fa0c0aea11583b5a7687b7cc32ab375bab0aca3fa5b00ffffffff02d397d404000000001976a9147d5371b813718a184eda7ee68677478c94a5b50b88aca4811100000000001976a914f3c8fa4244b2468fd7cbdd56b05b3725d870a54d88ac000000000100000001fad578e6d94939bb8ec08b69031611b0a355247d9eb455707cdc2336dc3fa61e01000000171600145a0465407008adf7b8fa417f090a3f42631397390000000002809698000000000017a914e01c8e754636565903e029ec81844e97b64847c8876b905b000000000017a914daefb33b7a7d09ccaf84d6349790181b30f73c1d8700000000010000000533638aeba551e45e2efd0dea3b496e7e8fffbc4695ca2cca45f00f540a6fdb000400000000ffffffffccdf17746aa8af29874a70b7761e9ed1bee4538a5a3128a4e2cc98cbf1992a190400000000ffffffff20998a6a2e46945ad50f96a36a0efe4545098e48d545b5deffd3d066554ff62d0500000000ffffffff97121bc50a7d0679b14539e9b6d309e482323dbd00b3bbecdda93a4a6e222c460600000000ffffffff633e6b68d0611dee3f5cc0c7cae58f15df2dc2efed4b7cb6c9da73b1115598cf0600000000ffffffff0540420f00000000001600140d258ddcef3639585e002c252e45bd660efc3c4c40420f00000000001600141cde7ea0a4afa7fe7b990e33bfb1a573b877aa5e40420f00000000001600143f34a0b6d739d6b31aa5cae39546f0cb2372e3c440420f000000000016001456b459fa5a02bc075c312966eff549750e90e75140420f0000000000160014cc6467c58558554c594a06b80127ba9612ce5d620000000001000000017381b4c985d951f79a23a45d2fd9d2d633128a0502681060ffc6e9cd7ea8f51d0000000000ffffffff0244f2b90000000000160014a23a855ab1ea62e2cd237ef2e3a89e945d0425bcd00700000000000017a91494150536b3e3c4cecec5f8e8c9fece5cff33f4a08700000000020000000240001e9ac8691018c1c1114cfb1bcad46a22550db703a12704e6cdc0333adeb5050000006b483045022100e5e239d1c2df4fb623fbb4c2d5f09fdbd20c2482c9298fb561b3d64e2760d38702203c642944df295f0c8025ca8240344c007a655ef3afceeebbb7debf6a060bc52d012103c6b6ebd707d3ea7156e918e1ebb98397c2e3ec7ec029b6136f8d3e22a93892c5feffffffd5e6c45f8467eb8e129145ee9c70ae03a4ba17c5b34a22f96562ced7816112460000000017160014c8a854d3bef26d1f77909d9b72bf5e815b1c82f9feffffff06b19801000000000017a914565289c10f4d5a6f91a5170eebefd177150da87b87219b0100000000001976a914aa25b49710a2896df84248820c9c0d53cbc4971988ac91a301000000000017a914080e233930f09e0ddc7d31d8e4c3b03a37ec06b487f5400f000000000017a91429b9b5dd6c241000fcd70afbac93cdb261c5343f876aad0100000000001976a91481cfd81e144aea28e60280a37acf860a765a0f6688acd19a0100000000001976a9148fe278735814712914e1f4dd4feacf890a0440b488acf6251600020000000130f416fa61d2da1f6641859b17c90beec75cdb9683136044e2bfe9306db0e4c701000000171600147bb9003f69772c8a1d66fb596bde0d64a94c4711fdffffff02a8610000000000001976a914ca888439e258a82240684ed25c7f975142a78c4f88ac8cd21d000000000017a914f268bafe553664b6253cdccd151c67ef692c953d87f6251600010000000268db415b9c6ca7696d7c5d227de5dbb36b3ac7bdd3d43548c3274e770ca9d4d3020000006a47304402200fb458da83dad29531f7bbbc0ec4a78c756708f781a4751617fc6d69eb700c0202203db3acfe2f40ad75391273fc7ded96e9f7fcb40b239c01788e406a4dac89d3b80121028ae90bf39b07fef22e3803335043b7e15942785e138def84a3b9ce948fd6c4adfeffffff037e5d32af82d4fc73fb59e1efb1379223c142dcb7653d784c1fcd3a7cdc57d0040000006a473044022043433841f4d48576288f2c6f764bfbe0d97d0c125faf40cadd5bc0fda3f582140220728eb923c044dba314a90bcf30c01165c7206b2f145a62638a2106797343b109012103eab162df45c5354ade110d764e2e06d25e0b67c5e24afe0b21b15e00c268ba0bfeffffff052a9c01000000000017a914b5dcdebc745f68e93e344cad411383389b15f42b87118b0100000000001976a91426a4e12633c2c53e9f6bacfe94f33f5dc6a77e3588ac0b8701000000000017a914080e233930f09e0ddc7d31d8e4c3b03a37ec06b48741420f00000000001976a9143ffe9255c921f3989696e5a7a5ca22599a1abd1588acf88e0100000000001976a914d603ba8fbb0e12fb8f5d241ec8a75dd52db54cd788acf6251600"


def btc_block(timestamp=None, real_block=None):
    if real_block is not None:
        return BlockBtcMessage(buf=bytearray(convert.hex_to_bytes(real_block)))
    if timestamp is None:
        timestamp = int(time.time())

    magic = 12345
    version = 23456
    prev_block_hash = bytearray(crypto.double_sha256(b"123"))
    prev_block = BtcObjectHash(prev_block_hash, length=SHA256_HASH_LEN)
    merkle_root_hash = bytearray(crypto.double_sha256(b"234"))
    merkle_root = BtcObjectHash(merkle_root_hash, length=SHA256_HASH_LEN)
    bits = 2
    nonce = 3

    txns = [TxBtcMessage(magic, version, [], [], i).rawbytes()[BTC_HDR_COMMON_OFF:] for i in range(10)]

    return BlockBtcMessage(magic, version, prev_block, merkle_root, timestamp, bits, nonce, txns)


def btc_version_message():
    return VersionBtcMessage(12345, 12345, LISTEN_ON_IP_ADDRESS, 1000, LISTEN_ON_IP_ADDRESS,
                             1000, 1, 2, b"bloxroute")


def generate_btc_tx() -> TxBtcMessage:
    inps = [TxIn(prev_outpoint_hash=bytearray("0" * 32, "utf-8"), prev_out_index=10, sig_script=bytearray(1000),
                 sequence=32)]

    outs = [TxOut(value=10, pk_script=bytearray(1000))]

    return TxBtcMessage(magic=100, version=1, tx_in=inps, tx_out=outs, lock_time=12345)
